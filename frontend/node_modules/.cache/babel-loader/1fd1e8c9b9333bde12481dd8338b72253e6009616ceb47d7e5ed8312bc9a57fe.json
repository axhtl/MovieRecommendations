{"ast":null,"code":"import React,{useState}from'react';import'../styles/Chatbot.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Chatbot=_ref=>{let{isOpen,onClose}=_ref;const[messages,setMessages]=useState([]);// 대화 내역\nconst[input,setInput]=useState('');// 입력된 메시지\nconst userName='사용자';// 사용자 이름\nconst aiName='AI';// AI 이름\nconst userProfile='https://via.placeholder.com/40?text=U';// 사용자 프로필 이미지\nconst aiProfile='https://via.placeholder.com/40?text=AI';// AI 프로필 이미지\n// 메시지 전송 처리\nconst handleSend=async()=>{if(!input.trim())return;// 빈 메시지 처리\nconst timestamp=new Date().toLocaleTimeString();// 현재 시간\nconst userMessage={sender:'user',text:input,time:timestamp,name:userName,profile:userProfile};setMessages(prev=>[...prev,userMessage]);try{var _data$;const token=localStorage.getItem('token');// 토큰 가져오기\nif(!token){throw new Error('로그인이 필요합니다. 토큰이 없습니다.');}const response=await fetch('/api/ai/chatbot',{method:'POST',headers:{'Content-Type':'application/json',Authorization:\"Bearer \".concat(token)// 토큰 추가\n},body:JSON.stringify({text:input})// 요청 본문에 입력된 텍스트 추가\n});if(!response.ok){throw new Error(\"HTTP \\uC0C1\\uD0DC \\uCF54\\uB4DC: \".concat(response.status));}const data=await response.json();const aiMessage={sender:'ai',text:((_data$=data[0])===null||_data$===void 0?void 0:_data$.llm_response)||data.llm_response||'AI 응답 없음',time:new Date().toLocaleTimeString(),name:aiName,profile:aiProfile};setMessages(prev=>[...prev,aiMessage]);}catch(error){console.error('AI 응답 처리 중 오류 발생:',error);const errorMessage={sender:'ai',text:'AI 응답 처리에 실패했습니다. 나중에 다시 시도해 주세요.',time:new Date().toLocaleTimeString(),name:aiName,profile:aiProfile};setMessages(prev=>[...prev,errorMessage]);}setInput('');};if(!isOpen)return null;// 창이 닫혀있으면 렌더링하지 않음\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"chat-window\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\uCC57\\uBD07\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"chat-close-button\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-messages\",children:messages.map((msg,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"chat-message \".concat(msg.sender==='user'?'user-message':'bot-message'),children:[/*#__PURE__*/_jsx(\"img\",{src:msg.profile,alt:\"\".concat(msg.name,\" profile\"),className:\"chat-profile\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-message-header\",children:[msg.name,\" \\u2022 \",msg.time]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-message-content\",children:msg.text})]})]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-input\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:input,onChange:e=>setInput(e.target.value),placeholder:\"\\uBA54\\uC2DC\\uC9C0\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694...\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSend,children:\"\\uC804\\uC1A1\"})]})]});};export default Chatbot;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","Chatbot","_ref","isOpen","onClose","messages","setMessages","input","setInput","userName","aiName","userProfile","aiProfile","handleSend","trim","timestamp","Date","toLocaleTimeString","userMessage","sender","text","time","name","profile","prev","_data$","token","localStorage","getItem","Error","response","fetch","method","headers","Authorization","concat","body","JSON","stringify","ok","status","data","json","aiMessage","llm_response","error","console","errorMessage","className","children","onClick","map","msg","index","src","alt","type","value","onChange","e","target","placeholder"],"sources":["C:/Users/MovieRecommendations/frontend/src/components/list/Chatbot.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport '../styles/Chatbot.css';\r\n\r\nconst Chatbot = ({ isOpen, onClose }) => {\r\n  const [messages, setMessages] = useState([]); // 대화 내역\r\n  const [input, setInput] = useState(''); // 입력된 메시지\r\n  const userName = '사용자'; // 사용자 이름\r\n  const aiName = 'AI'; // AI 이름\r\n  const userProfile = 'https://via.placeholder.com/40?text=U'; // 사용자 프로필 이미지\r\n  const aiProfile = 'https://via.placeholder.com/40?text=AI'; // AI 프로필 이미지\r\n\r\n  // 메시지 전송 처리\r\n  const handleSend = async () => {\r\n    if (!input.trim()) return; // 빈 메시지 처리\r\n\r\n    const timestamp = new Date().toLocaleTimeString(); // 현재 시간\r\n    const userMessage = {\r\n      sender: 'user',\r\n      text: input,\r\n      time: timestamp,\r\n      name: userName,\r\n      profile: userProfile,\r\n    };\r\n\r\n    setMessages((prev) => [...prev, userMessage]);\r\n\r\n    try {\r\n      const token = localStorage.getItem('token'); // 토큰 가져오기\r\n      if (!token) {\r\n        throw new Error('로그인이 필요합니다. 토큰이 없습니다.');\r\n      }\r\n\r\n      const response = await fetch('/api/ai/chatbot', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${token}`, // 토큰 추가\r\n        },\r\n        body: JSON.stringify({ text: input }), // 요청 본문에 입력된 텍스트 추가\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP 상태 코드: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n\r\n      const aiMessage = {\r\n        sender: 'ai',\r\n        text: data[0]?.llm_response || data.llm_response || 'AI 응답 없음',\r\n        time: new Date().toLocaleTimeString(),\r\n        name: aiName,\r\n        profile: aiProfile,\r\n      };\r\n\r\n      setMessages((prev) => [...prev, aiMessage]);\r\n    } catch (error) {\r\n      console.error('AI 응답 처리 중 오류 발생:', error);\r\n\r\n      const errorMessage = {\r\n        sender: 'ai',\r\n        text: 'AI 응답 처리에 실패했습니다. 나중에 다시 시도해 주세요.',\r\n        time: new Date().toLocaleTimeString(),\r\n        name: aiName,\r\n        profile: aiProfile,\r\n      };\r\n\r\n      setMessages((prev) => [...prev, errorMessage]);\r\n    }\r\n\r\n    setInput('');\r\n  };\r\n\r\n  if (!isOpen) return null; // 창이 닫혀있으면 렌더링하지 않음\r\n\r\n  return (\r\n    <div className=\"chat-window\">\r\n      <div className=\"chat-header\">\r\n        <h4>챗봇</h4>\r\n        <button onClick={onClose} className=\"chat-close-button\">×</button>\r\n      </div>\r\n      <div className=\"chat-messages\">\r\n        {messages.map((msg, index) => (\r\n          <div\r\n            key={index}\r\n            className={`chat-message ${\r\n              msg.sender === 'user' ? 'user-message' : 'bot-message'\r\n            }`}\r\n          >\r\n            <img\r\n              src={msg.profile}\r\n              alt={`${msg.name} profile`}\r\n              className=\"chat-profile\"\r\n            />\r\n            <div>\r\n              <div className=\"chat-message-header\">\r\n                {msg.name} • {msg.time}\r\n              </div>\r\n              <div className=\"chat-message-content\">{msg.text}</div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n      <div className=\"chat-input\">\r\n        <input\r\n          type=\"text\"\r\n          value={input}\r\n          onChange={(e) => setInput(e.target.value)}\r\n          placeholder=\"메시지를 입력하세요...\"\r\n        />\r\n        <button onClick={handleSend}>전송</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chatbot;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}