{"ast":null,"code":"import React,{useState}from'react';import{useNavigate,useParams}from'react-router-dom';import'../styles/Chatbot.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Chatbot=_ref=>{let{isOpen,onClose}=_ref;const{memberId}=useParams();// URL에서 memberId 가져오기\nconst navigate=useNavigate();const[messages,setMessages]=useState([]);// 대화 내역\nconst[input,setInput]=useState('');// 입력된 메시지\nconst userName='사용자';// 사용자 이름\nconst aiName='AI';// AI 이름\nconst userProfile='https://via.placeholder.com/40?text=U';// 사용자 프로필 이미지\nconst aiProfile='https://via.placeholder.com/40?text=AI';// AI 프로필 이미지\n// 메시지 전송 처리\nconst handleSend=async()=>{if(!input.trim())return;// 빈 메시지 처리\nconst timestamp=new Date().toLocaleTimeString();// 현재 시간\nconst userMessage={sender:'user',text:input,time:timestamp,name:userName,profile:userProfile};// 사용자 메시지 추가\nsetMessages(prev=>[...prev,userMessage]);try{var _data$;// Spring Boot API 요청 보내기\nconst response=await fetch(\"/api/ai/chatbot/\".concat(memberId),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(input)// input을 단순 문자열로 전송\n});if(!response.ok){throw new Error(\"\\uB124\\uD2B8\\uC6CC\\uD06C \\uC751\\uB2F5\\uC5D0 \\uBB38\\uC81C\\uAC00 \\uC788\\uC2B5\\uB2C8\\uB2E4. \\uC0C1\\uD0DC \\uCF54\\uB4DC: \".concat(response.status));}const data=await response.json();const aiMessage={sender:'ai',text:((_data$=data[0])===null||_data$===void 0?void 0:_data$.llm_response)||'AI 응답 없음',time:new Date().toLocaleTimeString(),name:aiName,profile:aiProfile};// AI 메시지 추가\nsetMessages(prev=>[...prev,aiMessage]);}catch(error){console.error('AI 응답 처리 중 오류 발생:',error);// 에러 메시지 추가\nconst errorMessage={sender:'ai',text:'AI 응답 처리에 실패했습니다. 나중에 다시 시도해 주세요.',time:new Date().toLocaleTimeString(),name:aiName,profile:aiProfile};setMessages(prev=>[...prev,errorMessage]);}setInput('');// 입력 초기화\n};if(!isOpen)return null;// 창이 닫혀있으면 렌더링하지 않음\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"chat-window\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\uCC57\\uBD07\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"chat-close-button\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-messages\",children:messages.map((msg,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"chat-message \".concat(msg.sender==='user'?'user-message':'bot-message'),children:[/*#__PURE__*/_jsx(\"img\",{src:msg.profile,alt:\"\".concat(msg.name,\" profile\"),className:\"chat-profile\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-message-header\",children:[msg.name,\" \\u2022 \",msg.time]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-message-content\",children:msg.text})]})]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-input\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:input,onChange:e=>setInput(e.target.value),placeholder:\"\\uBA54\\uC2DC\\uC9C0\\uB97C \\uC785\\uB825\\uD558\\uC138\\uC694...\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSend,children:\"\\uC804\\uC1A1\"})]})]});};export default Chatbot;","map":{"version":3,"names":["React","useState","useNavigate","useParams","jsx","_jsx","jsxs","_jsxs","Chatbot","_ref","isOpen","onClose","memberId","navigate","messages","setMessages","input","setInput","userName","aiName","userProfile","aiProfile","handleSend","trim","timestamp","Date","toLocaleTimeString","userMessage","sender","text","time","name","profile","prev","_data$","response","fetch","concat","method","headers","body","JSON","stringify","ok","Error","status","data","json","aiMessage","llm_response","error","console","errorMessage","className","children","onClick","map","msg","index","src","alt","type","value","onChange","e","target","placeholder"],"sources":["C:/Users/MovieRecommendations/frontend/src/components/list/Chatbot.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useNavigate, useParams } from 'react-router-dom';\r\nimport '../styles/Chatbot.css';\r\n\r\nconst Chatbot = ({ isOpen, onClose }) => {\r\n  const { memberId } = useParams(); // URL에서 memberId 가져오기\r\n  const navigate = useNavigate();\r\n  const [messages, setMessages] = useState([]); // 대화 내역\r\n  const [input, setInput] = useState(''); // 입력된 메시지\r\n  const userName = '사용자'; // 사용자 이름\r\n  const aiName = 'AI'; // AI 이름\r\n  const userProfile = 'https://via.placeholder.com/40?text=U'; // 사용자 프로필 이미지\r\n  const aiProfile = 'https://via.placeholder.com/40?text=AI'; // AI 프로필 이미지\r\n\r\n  // 메시지 전송 처리\r\n  const handleSend = async () => {\r\n    if (!input.trim()) return; // 빈 메시지 처리\r\n\r\n    const timestamp = new Date().toLocaleTimeString(); // 현재 시간\r\n    const userMessage = {\r\n      sender: 'user',\r\n      text: input,\r\n      time: timestamp,\r\n      name: userName,\r\n      profile: userProfile,\r\n    };\r\n\r\n    // 사용자 메시지 추가\r\n    setMessages((prev) => [...prev, userMessage]);\r\n\r\n    try {\r\n      // Spring Boot API 요청 보내기\r\n      const response = await fetch(`/api/ai/chatbot/${memberId}`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(input), // input을 단순 문자열로 전송\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`네트워크 응답에 문제가 있습니다. 상태 코드: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      const aiMessage = {\r\n        sender: 'ai',\r\n        text: data[0]?.llm_response || 'AI 응답 없음',\r\n        time: new Date().toLocaleTimeString(),\r\n        name: aiName,\r\n        profile: aiProfile,\r\n      };\r\n\r\n      // AI 메시지 추가\r\n      setMessages((prev) => [...prev, aiMessage]);\r\n    } catch (error) {\r\n      console.error('AI 응답 처리 중 오류 발생:', error);\r\n\r\n      // 에러 메시지 추가\r\n      const errorMessage = {\r\n        sender: 'ai',\r\n        text: 'AI 응답 처리에 실패했습니다. 나중에 다시 시도해 주세요.',\r\n        time: new Date().toLocaleTimeString(),\r\n        name: aiName,\r\n        profile: aiProfile,\r\n      };\r\n\r\n      setMessages((prev) => [...prev, errorMessage]);\r\n    }\r\n\r\n    setInput(''); // 입력 초기화\r\n  };\r\n\r\n  if (!isOpen) return null; // 창이 닫혀있으면 렌더링하지 않음\r\n\r\n  return (\r\n    <div className=\"chat-window\">\r\n      <div className=\"chat-header\">\r\n        <h4>챗봇</h4>\r\n        <button onClick={onClose} className=\"chat-close-button\">×</button>\r\n      </div>\r\n      <div className=\"chat-messages\">\r\n        {messages.map((msg, index) => (\r\n          <div\r\n            key={index}\r\n            className={`chat-message ${\r\n              msg.sender === 'user' ? 'user-message' : 'bot-message'\r\n            }`}\r\n          >\r\n            <img\r\n              src={msg.profile}\r\n              alt={`${msg.name} profile`}\r\n              className=\"chat-profile\"\r\n            />\r\n            <div>\r\n              <div className=\"chat-message-header\">\r\n                {msg.name} • {msg.time}\r\n              </div>\r\n              <div className=\"chat-message-content\">{msg.text}</div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n      <div className=\"chat-input\">\r\n        <input\r\n          type=\"text\"\r\n          value={input}\r\n          onChange={(e) => setInput(e.target.value)}\r\n          placeholder=\"메시지를 입력하세요...\"\r\n        />\r\n        <button onClick={handleSend}>전송</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chatbot;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}