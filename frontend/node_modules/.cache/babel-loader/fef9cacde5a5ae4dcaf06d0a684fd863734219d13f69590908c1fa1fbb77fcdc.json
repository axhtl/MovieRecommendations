{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import AdminNavbar from'../ui/AdminNavbar';import{Chart as ChartJS,ArcElement,Tooltip,Legend}from'chart.js';import{Pie}from'react-chartjs-2';import'../styles/admin/AdminReports.css';// 스타일 파일\n// Chart.js 요소 등록\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";ChartJS.register(ArcElement,Tooltip,Legend);function AdminReports(){const[userData,setUserData]=useState([]);const navigate=useNavigate();useEffect(()=>{const memberId=localStorage.getItem('memberId');const token=localStorage.getItem('token');if(!memberId||memberId!=='14'||!token){alert('접근 권한이 없습니다.');navigate('/');return;}const fetchUserData=async()=>{try{const response=await fetch('/member/users',{headers:{Authorization:\"Bearer \".concat(token)}});const data=await response.json();setUserData(data);}catch(error){console.error('데이터를 가져오는 중 오류 발생:',error);}};fetchUserData();},[navigate]);// 통계 데이터 계산\nconst calculateStats=()=>{const genderStats={male:0,female:0};const ageStats={};const genreStats={};userData.forEach(user=>{// 성별 통계\nif(user.survey.gender==='M')genderStats.male+=1;if(user.survey.gender==='F')genderStats.female+=1;// 나이 통계\nconst ageGroup=\"\".concat(Math.floor(user.survey.age/10)*10,\"\\uB300\");// 10대, 20대 형식\nageStats[ageGroup]=(ageStats[ageGroup]||0)+1;// 선호 장르 통계\nuser.preferredGenres.forEach(genre=>{genreStats[genre]=(genreStats[genre]||0)+1;});});return{genderStats,ageStats,genreStats};};const{genderStats,ageStats,genreStats}=calculateStats();// 차트 데이터 생성\nconst pieChartData=(labels,data)=>({labels,datasets:[{label:'통계',data,backgroundColor:['#36A2EB','#FF6384','#FFCE56','#4BC0C0','#9966FF'],hoverBackgroundColor:['#36A2EB','#FF6384','#FFCE56','#4BC0C0','#9966FF']}]});return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-page\",children:[/*#__PURE__*/_jsx(AdminNavbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-content\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uC11C\\uBE44\\uC2A4 \\uD1B5\\uACC4 \\uC870\\uD68C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"charts-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chart\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uC0AC\\uC6A9\\uC790 \\uC120\\uD638 \\uC7A5\\uB974 \\uD1B5\\uACC4\"}),/*#__PURE__*/_jsx(Pie,{data:pieChartData(Object.keys(genreStats),Object.values(genreStats))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uC131\\uBCC4 \\uD1B5\\uACC4\"}),/*#__PURE__*/_jsx(Pie,{data:pieChartData(['Male','Female'],[genderStats.male,genderStats.female])})]}),Object.entries(ageStats).map(_ref=>{let[ageGroup,count]=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"chart\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[ageGroup,\" \\uC120\\uD638 \\uC7A5\\uB974 \\uD1B5\\uACC4\"]}),/*#__PURE__*/_jsx(Pie,{data:pieChartData(Object.keys(genreStats),Object.values(genreStats))})]},ageGroup);})]})]})]});}export default AdminReports;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","AdminNavbar","Chart","ChartJS","ArcElement","Tooltip","Legend","Pie","jsx","_jsx","jsxs","_jsxs","register","AdminReports","userData","setUserData","navigate","memberId","localStorage","getItem","token","alert","fetchUserData","response","fetch","headers","Authorization","concat","data","json","error","console","calculateStats","genderStats","male","female","ageStats","genreStats","forEach","user","survey","gender","ageGroup","Math","floor","age","preferredGenres","genre","pieChartData","labels","datasets","label","backgroundColor","hoverBackgroundColor","className","children","Object","keys","values","entries","map","_ref","count"],"sources":["C:/Users/MovieRecommendations/frontend/src/components/admin/AdminReports.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport AdminNavbar from '../ui/AdminNavbar';\r\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend } from 'chart.js';\r\nimport { Pie } from 'react-chartjs-2';\r\nimport '../styles/admin/AdminReports.css'; // 스타일 파일\r\n\r\n// Chart.js 요소 등록\r\nChartJS.register(ArcElement, Tooltip, Legend);\r\n\r\nfunction AdminReports() {\r\n  const [userData, setUserData] = useState([]);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const memberId = localStorage.getItem('memberId');\r\n    const token = localStorage.getItem('token');\r\n\r\n    if (!memberId || memberId !== '14' || !token) {\r\n      alert('접근 권한이 없습니다.');\r\n      navigate('/');\r\n      return;\r\n    }\r\n\r\n    const fetchUserData = async () => {\r\n      try {\r\n        const response = await fetch('/member/users', {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        const data = await response.json();\r\n        setUserData(data);\r\n      } catch (error) {\r\n        console.error('데이터를 가져오는 중 오류 발생:', error);\r\n      }\r\n    };\r\n\r\n    fetchUserData();\r\n  }, [navigate]);\r\n\r\n  // 통계 데이터 계산\r\n  const calculateStats = () => {\r\n    const genderStats = { male: 0, female: 0 };\r\n    const ageStats = {};\r\n    const genreStats = {};\r\n\r\n    userData.forEach((user) => {\r\n      // 성별 통계\r\n      if (user.survey.gender === 'M') genderStats.male += 1;\r\n      if (user.survey.gender === 'F') genderStats.female += 1;\r\n\r\n      // 나이 통계\r\n      const ageGroup = `${Math.floor(user.survey.age / 10) * 10}대`; // 10대, 20대 형식\r\n      ageStats[ageGroup] = (ageStats[ageGroup] || 0) + 1;\r\n\r\n      // 선호 장르 통계\r\n      user.preferredGenres.forEach((genre) => {\r\n        genreStats[genre] = (genreStats[genre] || 0) + 1;\r\n      });\r\n    });\r\n\r\n    return { genderStats, ageStats, genreStats };\r\n  };\r\n\r\n  const { genderStats, ageStats, genreStats } = calculateStats();\r\n\r\n  // 차트 데이터 생성\r\n  const pieChartData = (labels, data) => ({\r\n    labels,\r\n    datasets: [\r\n      {\r\n        label: '통계',\r\n        data,\r\n        backgroundColor: ['#36A2EB', '#FF6384', '#FFCE56', '#4BC0C0', '#9966FF'],\r\n        hoverBackgroundColor: ['#36A2EB', '#FF6384', '#FFCE56', '#4BC0C0', '#9966FF'],\r\n      },\r\n    ],\r\n  });\r\n\r\n  return (\r\n    <div className=\"admin-page\">\r\n      <AdminNavbar />\r\n      <div className=\"admin-content\">\r\n        <h1>서비스 통계 조회</h1>\r\n        <div className=\"charts-container\">\r\n          {/* 사용자 선호 장르 통계 */}\r\n          <div className=\"chart\">\r\n            <h3>사용자 선호 장르 통계</h3>\r\n            <Pie data={pieChartData(Object.keys(genreStats), Object.values(genreStats))} />\r\n          </div>\r\n\r\n          {/* 성별 통계 */}\r\n          <div className=\"chart\">\r\n            <h3>성별 통계</h3>\r\n            <Pie data={pieChartData(['Male', 'Female'], [genderStats.male, genderStats.female])} />\r\n          </div>\r\n\r\n          {/* 연령별 선호 장르 통계 */}\r\n          {Object.entries(ageStats).map(([ageGroup, count]) => (\r\n            <div className=\"chart\" key={ageGroup}>\r\n              <h3>{ageGroup} 선호 장르 통계</h3>\r\n              <Pie data={pieChartData(Object.keys(genreStats), Object.values(genreStats))} />\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AdminReports;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}