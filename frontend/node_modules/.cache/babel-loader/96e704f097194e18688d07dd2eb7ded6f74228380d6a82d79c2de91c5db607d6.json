{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import StarRating from'./StarRating';import'../styles/RegiMovieList.css';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const RegiMovieList=_ref=>{let{movies}=_ref;const[movieDetails,setMovieDetails]=useState({});const[ratings,setRatings]=useState({});const navigate=useNavigate();useEffect(()=>{const fetchData=async()=>{try{const token=localStorage.getItem('token');const memberId=localStorage.getItem('memberId');if(!token||!memberId){alert('로그인이 필요합니다.');return;}// 회원 정보 가져오기\nconst userResponse=await axios.get(\"/member/user/\".concat(memberId),{headers:{Authorization:\"Bearer \".concat(token)}});const userReviews=userResponse.data.reviews||[];const reviewInfos=userResponse.data.reviewInfos||[];// 별점 데이터 매핑\nconst reviewsMap=userReviews.reduce((acc,review)=>{acc[review.reviewId]=Number(review.ranked);return acc;},{});// 영화 포스터 데이터 가져오기\nconst posterPromises=reviewInfos.map(info=>axios.get(\"/api/movies/detail/\".concat(info.movieInfo.movieId),{params:{language:'ko'},headers:{Authorization:\"Bearer \".concat(token)}}).then(response=>({movieId:info.movieInfo.movieId,posterPath:response.data.poster_path})).catch(()=>({movieId:info.movieInfo.movieId,posterPath:null})));const posterResults=await Promise.all(posterPromises);// 포스터 데이터 매핑\nconst posterMap=posterResults.reduce((acc,detail)=>{acc[detail.movieId]=detail.posterPath;return acc;},{});setRatings(reviewsMap);setMovieDetails(posterMap);}catch(error){var _error$response;console.error('데이터를 가져오는 중 오류 발생:',((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);alert('영화 정보를 불러오는 중 문제가 발생했습니다.');}};fetchData();},[movies]);const scrollLeft=()=>{document.querySelector('.movie-list-container').scrollBy({left:-200,behavior:'smooth'});};const scrollRight=()=>{document.querySelector('.movie-list-container').scrollBy({left:200,behavior:'smooth'});};const handleMovieClick=review=>{navigate(\"/movies/\".concat(review.movieInfo.movieId),{state:{reviewId:review.reviewId}});};return/*#__PURE__*/_jsxs(\"div\",{className:\"regi-movie-list\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"scroll-button left\",onClick:scrollLeft,children:\"\\u2039\"}),/*#__PURE__*/_jsx(\"div\",{className:\"movie-list-container\",children:movies.map(review=>/*#__PURE__*/_jsxs(\"div\",{className:\"movie-item\",onClick:()=>handleMovieClick(review),children:[/*#__PURE__*/_jsx(\"img\",{src:movieDetails[review.movieInfo.movieId]?\"https://image.tmdb.org/t/p/w500\".concat(movieDetails[review.movieInfo.movieId]):'/icons/default-image-url.jpg',alt:review.movieInfo.title||'영화 이미지',onError:e=>{e.target.src='/icons/default-image-url.jpg';}}),/*#__PURE__*/_jsx(\"h3\",{children:review.movieInfo.title||'제목 없음'}),/*#__PURE__*/_jsx(\"div\",{className:\"movie-rating\",children:/*#__PURE__*/_jsx(StarRating,{rating:ratings[review.reviewId]||0,readOnly:true})})]},review.reviewId))}),/*#__PURE__*/_jsx(\"button\",{className:\"scroll-button right\",onClick:scrollRight,children:\"\\u203A\"})]});};export default RegiMovieList;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","StarRating","axios","jsx","_jsx","jsxs","_jsxs","RegiMovieList","_ref","movies","movieDetails","setMovieDetails","ratings","setRatings","navigate","fetchData","token","localStorage","getItem","memberId","alert","userResponse","get","concat","headers","Authorization","userReviews","data","reviews","reviewInfos","reviewsMap","reduce","acc","review","reviewId","Number","ranked","posterPromises","map","info","movieInfo","movieId","params","language","then","response","posterPath","poster_path","catch","posterResults","Promise","all","posterMap","detail","error","_error$response","console","message","scrollLeft","document","querySelector","scrollBy","left","behavior","scrollRight","handleMovieClick","state","className","children","onClick","src","alt","title","onError","e","target","rating","readOnly"],"sources":["C:/Users/MovieRecommendations/frontend/src/components/list/RegiMovieList.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport StarRating from './StarRating';\r\nimport '../styles/RegiMovieList.css';\r\nimport axios from 'axios';\r\n\r\nconst RegiMovieList = ({ movies }) => {\r\n  const [movieDetails, setMovieDetails] = useState({});\r\n  const [ratings, setRatings] = useState({});\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        const memberId = localStorage.getItem('memberId');\r\n        if (!token || !memberId) {\r\n          alert('로그인이 필요합니다.');\r\n          return;\r\n        }\r\n\r\n        // 회원 정보 가져오기\r\n        const userResponse = await axios.get(`/member/user/${memberId}`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n\r\n        const userReviews = userResponse.data.reviews || [];\r\n        const reviewInfos = userResponse.data.reviewInfos || [];\r\n\r\n        // 별점 데이터 매핑\r\n        const reviewsMap = userReviews.reduce((acc, review) => {\r\n          acc[review.reviewId] = Number(review.ranked);\r\n          return acc;\r\n        }, {});\r\n\r\n        // 영화 포스터 데이터 가져오기\r\n        const posterPromises = reviewInfos.map((info) =>\r\n          axios\r\n            .get(`/api/movies/detail/${info.movieInfo.movieId}`, {\r\n              params: { language: 'ko' },\r\n              headers: { Authorization: `Bearer ${token}` },\r\n            })\r\n            .then((response) => ({\r\n              movieId: info.movieInfo.movieId,\r\n              posterPath: response.data.poster_path,\r\n            }))\r\n            .catch(() => ({\r\n              movieId: info.movieInfo.movieId,\r\n              posterPath: null,\r\n            }))\r\n        );\r\n\r\n        const posterResults = await Promise.all(posterPromises);\r\n\r\n        // 포스터 데이터 매핑\r\n        const posterMap = posterResults.reduce((acc, detail) => {\r\n          acc[detail.movieId] = detail.posterPath;\r\n          return acc;\r\n        }, {});\r\n\r\n        setRatings(reviewsMap);\r\n        setMovieDetails(posterMap);\r\n      } catch (error) {\r\n        console.error('데이터를 가져오는 중 오류 발생:', error.response?.data || error.message);\r\n        alert('영화 정보를 불러오는 중 문제가 발생했습니다.');\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [movies]);\r\n\r\n  const scrollLeft = () => {\r\n    document.querySelector('.movie-list-container').scrollBy({\r\n      left: -200,\r\n      behavior: 'smooth',\r\n    });\r\n  };\r\n\r\n  const scrollRight = () => {\r\n    document.querySelector('.movie-list-container').scrollBy({\r\n      left: 200,\r\n      behavior: 'smooth',\r\n    });\r\n  };\r\n\r\n  const handleMovieClick = (review) => {\r\n    navigate(`/movies/${review.movieInfo.movieId}`, {\r\n      state: { reviewId: review.reviewId },\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"regi-movie-list\">\r\n      <button className=\"scroll-button left\" onClick={scrollLeft}>\r\n        &#8249;\r\n      </button>\r\n\r\n      <div className=\"movie-list-container\">\r\n        {movies.map((review) => (\r\n          <div\r\n            key={review.reviewId}\r\n            className=\"movie-item\"\r\n            onClick={() => handleMovieClick(review)}\r\n          >\r\n            <img\r\n              src={\r\n                movieDetails[review.movieInfo.movieId]\r\n                  ? `https://image.tmdb.org/t/p/w500${movieDetails[review.movieInfo.movieId]}`\r\n                  : '/icons/default-image-url.jpg'\r\n              }\r\n              alt={review.movieInfo.title || '영화 이미지'}\r\n              onError={(e) => {\r\n                e.target.src = '/icons/default-image-url.jpg';\r\n              }}\r\n            />\r\n            <h3>{review.movieInfo.title || '제목 없음'}</h3>\r\n            <div className=\"movie-rating\">\r\n              <StarRating\r\n                rating={ratings[review.reviewId] || 0}\r\n                readOnly\r\n              />\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <button className=\"scroll-button right\" onClick={scrollRight}>\r\n        &#8250;\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RegiMovieList;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,UAAU,KAAM,cAAc,CACrC,MAAO,6BAA6B,CACpC,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE1B,KAAM,CAAAC,aAAa,CAAGC,IAAA,EAAgB,IAAf,CAAEC,MAAO,CAAC,CAAAD,IAAA,CAC/B,KAAM,CAACE,YAAY,CAAEC,eAAe,CAAC,CAAGZ,QAAQ,CAAC,CAAC,CAAC,CAAC,CACpD,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAC,CAAC,CAAC,CAAC,CAC1C,KAAM,CAAAe,QAAQ,CAAGd,WAAW,CAAC,CAAC,CAE9BF,SAAS,CAAC,IAAM,CACd,KAAM,CAAAiB,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACF,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAC,QAAQ,CAAGF,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,CACjD,GAAI,CAACF,KAAK,EAAI,CAACG,QAAQ,CAAE,CACvBC,KAAK,CAAC,aAAa,CAAC,CACpB,OACF,CAEA;AACA,KAAM,CAAAC,YAAY,CAAG,KAAM,CAAAnB,KAAK,CAACoB,GAAG,iBAAAC,MAAA,CAAiBJ,QAAQ,EAAI,CAC/DK,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAYP,KAAK,CAAG,CAC9C,CAAC,CAAC,CAEF,KAAM,CAAAU,WAAW,CAAGL,YAAY,CAACM,IAAI,CAACC,OAAO,EAAI,EAAE,CACnD,KAAM,CAAAC,WAAW,CAAGR,YAAY,CAACM,IAAI,CAACE,WAAW,EAAI,EAAE,CAEvD;AACA,KAAM,CAAAC,UAAU,CAAGJ,WAAW,CAACK,MAAM,CAAC,CAACC,GAAG,CAAEC,MAAM,GAAK,CACrDD,GAAG,CAACC,MAAM,CAACC,QAAQ,CAAC,CAAGC,MAAM,CAACF,MAAM,CAACG,MAAM,CAAC,CAC5C,MAAO,CAAAJ,GAAG,CACZ,CAAC,CAAE,CAAC,CAAC,CAAC,CAEN;AACA,KAAM,CAAAK,cAAc,CAAGR,WAAW,CAACS,GAAG,CAAEC,IAAI,EAC1CrC,KAAK,CACFoB,GAAG,uBAAAC,MAAA,CAAuBgB,IAAI,CAACC,SAAS,CAACC,OAAO,EAAI,CACnDC,MAAM,CAAE,CAAEC,QAAQ,CAAE,IAAK,CAAC,CAC1BnB,OAAO,CAAE,CAAEC,aAAa,WAAAF,MAAA,CAAYP,KAAK,CAAG,CAC9C,CAAC,CAAC,CACD4B,IAAI,CAAEC,QAAQ,GAAM,CACnBJ,OAAO,CAAEF,IAAI,CAACC,SAAS,CAACC,OAAO,CAC/BK,UAAU,CAAED,QAAQ,CAAClB,IAAI,CAACoB,WAC5B,CAAC,CAAC,CAAC,CACFC,KAAK,CAAC,KAAO,CACZP,OAAO,CAAEF,IAAI,CAACC,SAAS,CAACC,OAAO,CAC/BK,UAAU,CAAE,IACd,CAAC,CAAC,CACN,CAAC,CAED,KAAM,CAAAG,aAAa,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAACd,cAAc,CAAC,CAEvD;AACA,KAAM,CAAAe,SAAS,CAAGH,aAAa,CAAClB,MAAM,CAAC,CAACC,GAAG,CAAEqB,MAAM,GAAK,CACtDrB,GAAG,CAACqB,MAAM,CAACZ,OAAO,CAAC,CAAGY,MAAM,CAACP,UAAU,CACvC,MAAO,CAAAd,GAAG,CACZ,CAAC,CAAE,CAAC,CAAC,CAAC,CAENnB,UAAU,CAACiB,UAAU,CAAC,CACtBnB,eAAe,CAACyC,SAAS,CAAC,CAC5B,CAAE,MAAOE,KAAK,CAAE,KAAAC,eAAA,CACdC,OAAO,CAACF,KAAK,CAAC,oBAAoB,CAAE,EAAAC,eAAA,CAAAD,KAAK,CAACT,QAAQ,UAAAU,eAAA,iBAAdA,eAAA,CAAgB5B,IAAI,GAAI2B,KAAK,CAACG,OAAO,CAAC,CAC1ErC,KAAK,CAAC,2BAA2B,CAAC,CACpC,CACF,CAAC,CAEDL,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,CAACN,MAAM,CAAC,CAAC,CAEZ,KAAM,CAAAiD,UAAU,CAAGA,CAAA,GAAM,CACvBC,QAAQ,CAACC,aAAa,CAAC,uBAAuB,CAAC,CAACC,QAAQ,CAAC,CACvDC,IAAI,CAAE,CAAC,GAAG,CACVC,QAAQ,CAAE,QACZ,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAC,WAAW,CAAGA,CAAA,GAAM,CACxBL,QAAQ,CAACC,aAAa,CAAC,uBAAuB,CAAC,CAACC,QAAQ,CAAC,CACvDC,IAAI,CAAE,GAAG,CACTC,QAAQ,CAAE,QACZ,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAE,gBAAgB,CAAIhC,MAAM,EAAK,CACnCnB,QAAQ,YAAAS,MAAA,CAAYU,MAAM,CAACO,SAAS,CAACC,OAAO,EAAI,CAC9CyB,KAAK,CAAE,CAAEhC,QAAQ,CAAED,MAAM,CAACC,QAAS,CACrC,CAAC,CAAC,CACJ,CAAC,CAED,mBACE5B,KAAA,QAAK6D,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BhE,IAAA,WAAQ+D,SAAS,CAAC,oBAAoB,CAACE,OAAO,CAAEX,UAAW,CAAAU,QAAA,CAAC,QAE5D,CAAQ,CAAC,cAEThE,IAAA,QAAK+D,SAAS,CAAC,sBAAsB,CAAAC,QAAA,CAClC3D,MAAM,CAAC6B,GAAG,CAAEL,MAAM,eACjB3B,KAAA,QAEE6D,SAAS,CAAC,YAAY,CACtBE,OAAO,CAAEA,CAAA,GAAMJ,gBAAgB,CAAChC,MAAM,CAAE,CAAAmC,QAAA,eAExChE,IAAA,QACEkE,GAAG,CACD5D,YAAY,CAACuB,MAAM,CAACO,SAAS,CAACC,OAAO,CAAC,mCAAAlB,MAAA,CACAb,YAAY,CAACuB,MAAM,CAACO,SAAS,CAACC,OAAO,CAAC,EACxE,8BACL,CACD8B,GAAG,CAAEtC,MAAM,CAACO,SAAS,CAACgC,KAAK,EAAI,QAAS,CACxCC,OAAO,CAAGC,CAAC,EAAK,CACdA,CAAC,CAACC,MAAM,CAACL,GAAG,CAAG,8BAA8B,CAC/C,CAAE,CACH,CAAC,cACFlE,IAAA,OAAAgE,QAAA,CAAKnC,MAAM,CAACO,SAAS,CAACgC,KAAK,EAAI,OAAO,CAAK,CAAC,cAC5CpE,IAAA,QAAK+D,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3BhE,IAAA,CAACH,UAAU,EACT2E,MAAM,CAAEhE,OAAO,CAACqB,MAAM,CAACC,QAAQ,CAAC,EAAI,CAAE,CACtC2C,QAAQ,MACT,CAAC,CACC,CAAC,GArBD5C,MAAM,CAACC,QAsBT,CACN,CAAC,CACC,CAAC,cAEN9B,IAAA,WAAQ+D,SAAS,CAAC,qBAAqB,CAACE,OAAO,CAAEL,WAAY,CAAAI,QAAA,CAAC,QAE9D,CAAQ,CAAC,EACN,CAAC,CAEV,CAAC,CAED,cAAe,CAAA7D,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}